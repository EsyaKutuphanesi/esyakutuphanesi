{% from "security/_macros.html" import render_field_with_errors, render_field %}
{% extends "layout.html" %}
{%block title%}Esya Kutuphanesi{%endblock%}
{% block content %}
    <script>
        $(function(){
            $("select#category").change(function(e){
                $.getJSON('/get_stuff_types/'+$(this).val(),'',function(j){
                    stuff_type = document.getElementById('stuff_type');
                    stuff_type.innerHTML = ''
                    $.each(j, function(key,value){
                        console.log(value);
                        stuff_type.innerHTML += "<option value='"+value.id+"'>"+value.name+"</option>";
                    });
                });
            });
        })
    </script>
    <div class="col-md-2"></div>
    <div class="col-md-5">
        <h1>Eşya Sayfası</h1>
        {% if not is_new %}
            {% if not stuff.approved %}
                <p class="alert-danger">Eşyanız henüz onaylanmadı</p>
            {% endif %}
        {% endif %}
        <form action="{{ form_action }}" method="POST" name="edit_stuff_form" enctype="multipart/form-data">
          {{ form.hidden_tag() }}
          {{ render_field_with_errors(form.title) }}
          {{ render_field_with_errors(form.category) }}
          {{ render_field_with_errors(form.stuff_type) }}
          {{ render_field_with_errors(form.detail) }}
          {{ render_field_with_errors(form.address) }}
            {{ render_field_with_errors(form.group) }}
          {{ render_field_with_errors(form.photo) }}
            {%for tag in stuff.tags%}
                <div class="btn btn-default">{{tag}}</div>
            {%endfor%}
          {{ render_field_with_errors(form.tags) }}
          {{ render_field(form.submit) }}
        </form>

    </div>
    <div class="col-md-5">
        {%if stuff%}
        <div class="row">
            {%for photo in stuff.photos%}
                <div class="col-md-6">
                    <img class="img-responsive" src="/photos/{{photo.filename}}" />
                </div>
            {%endfor%}
         </div>
        {%endif%}
    </div>
{% endblock %}

