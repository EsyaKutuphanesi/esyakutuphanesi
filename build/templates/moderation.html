{% from "security/_macros.html" import render_field_with_errors, render_field %}
{% extends "layout.html" %}
{%block title%}Esya Kutuphanesi{%endblock%}
{% block content %}
    <script>
        function approve(id){
            var url = '{{ url_for('moderation',action="approve") }}'
            window.location = url + '&id=' + id;
        }
        function approve_user(user_id){
            var url = '{{ url_for('moderation',user_action="approve_user") }}'
            window.location = url + '&user_id=' + user_id;
        }
    </script>
    <div class="col-md-12 col-sm-12">
        <h1>Bekleyen Eşyalar</h1>
        <table class="table table-bordered">
        <tr>
            <th>Grup</th>
            <th>Kullanıcı</th>
            <th>Eşya</th>
            <th>Detay</th>
            <th>Aksiyon</th>
        </tr>
            {% for stuff in last_objects %}
                <tr>
                    {% if stuff.group_id > 0 %}
                        <td>{{ stuff.group.name }}</td>
                    {% elif stuff.group_id == -1 %}
                        <td>Herkese Açık</td>
                    {% else %}
                        <td>Geçersiz</td>
                    {% endif %}
                    <td>{{ stuff.owner.name }}</td>
                    <td>{{ stuff }}</td>
                    <td>{{ stuff.detail }}</td>
                    <td>
                        <button class="btn btn-success" onclick="approve({{ stuff.id }})">Onayla</button>
                        <!--<button class="btn btn-danger">Reddet</button>-->
                    </td>
                </tr>
            {% endfor %}
        </table>
    </div>
    <div class="col-md-12 col-sm-12">
        <h1>Kullanıcılar</h1>
        <table class="table table-bordered">
        <tr>
            <th>id</th>
            <th>E-posta</th>
            <th>İsim soyisim</th>
            <th>Detay</th>
            <th>Aksiyon</th>
        </tr>
            {% for users in new_user %}
                <tr>
                    <td>{{ users.id }}</td>
                    <td>{{ users.email }}</td>
                    <td>{{ users.name  }}</td>
                    <td>{{ users.why }}</td>
                    <td>
                        {% if users.approved == 0%}
                        <button class="btn btn-success" onclick="approve_user({{ users.id }})">Onayla</button>
                        {% else %}
                        Onaylandı
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
        </table>
    </div>

{% endblock %}

